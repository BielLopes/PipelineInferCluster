const lib_quimico2sucata = { 
    "C": { "SARP": 0.1, "SCAVA": 0.2, "SEMR": 0.08, "SEST": 0.06, "SGUS": 4.10625, "SHD": 0.2, "SMST": 0.2, "SPES": 0.2, "SREC": 0.13, "SSHR": 0.2, "STES": 0.2, "SUCG": 4 },
    "Si": { "SARP": 0.15, "SCAVA": 0.15, "SEMR": 0.1, "SEST": 0.1, "SGUS": 0.9205, "SHD": 0.15, "SMST": 0.15, "SPES": 0.183333333333333, "SREC": 0.15, "SSHR": 0.15, "STES": 0.15, "SUCG": 0.66 },
    "Mn": { "SARP": 0.5, "SCAVA": 0.7, "SEMR": 0.55, "SEST": 0.6, "SGUS": 0.31225, "SHD": 0.7, "SMST": 0.7, "SPES": 0.733333333333333, "SREC": 0.45, "SSHR": 0.7, "STES": 0.75, "SUCG": 0.36 },
    "S": { "SARP": 0.02, "SCAVA": 0.04, "SEMR": 0.015, "SEST": 0.02, "SGUS": 0.02225, "SHD": 0.01, "SMST": 0.04, "SPES": 0.04, "SREC": 0.025, "SSHR": 0.01, "STES": 0.04, "SUCG": 0.054 },
    "P": { "SARP": 0.01, "SCAVA": 0.01, "SEMR": 0.01, "SEST": 0.01, "SGUS": 0.09475, "SHD": 0.01, "SMST": 0.01, "SPES": 0.01, "SREC": 0.01, "SSHR": 0.01, "STES": 0.01, "SUCG": 0.079 },
    "Cu": { "SARP": 0.05, "SCAVA": 0.23, "SEMR": 0.035, "SEST": 0.02, "SGUS": 0.00325, "SHD": 0.2, "SMST": 0.25, "SPES": 0.25, "SREC": 0.2, "SSHR": 0.2, "STES": 0.2, "SUCG": 0.013 },
    "Ni": { "SARP": 0.04, "SCAVA": 0.06, "SEMR": 0.03, "SEST": 0.02, "SGUS": 0.002, "SHD": 0.11, "SMST": 0.06, "SPES": 0.0733333333333333, "SREC": 0.09, "SSHR": 0.11, "STES": 0.08, "SUCG": 0.008 },
    "Cr": { "SARP": 0.04, "SCAVA": 0.3, "SEMR": 0.025, "SEST": 0.01, "SGUS": 0.0035, "SHD": 0.1, "SMST": 0.2, "SPES": 0.233333333333333, "SREC": 0.19, "SSHR": 0.1, "STES": 0.25, "SUCG": 0.014 },
    "Sn": { "SARP": 0.005, "SCAVA": 0.04, "SEMR": 0.01, "SEST": 0.2, "SGUS": 0.0005, "SHD": 0.02, "SMST": 0.04, "SPES": 0.0333333333333333, "SREC": 0.0175, "SSHR": 0.02, "STES": 0.03, "SUCG": 0.002 },
    "Nb": { "SARP": 0.005, "SCAVA": 0.02, "SEMR": 0.01, "SEST": 0.01, "SGUS": 0.0005, "SHD": 0.01, "SMST": 0.02, "SPES": 0.0166666666666667, "SREC": 0.0075, "SSHR": 0.01, "STES": 0.015, "SUCG": 0.002 },
    "Mo": { "SARP": 0.009, "SCAVA": 0.03, "SEMR": 0.01, "SEST": 0.01, "SGUS": 0.00025, "SHD": 0.01, "SMST": 0.03, "SPES": 0.0233333333333333, "SREC": 0.008, "SSHR": 0.01, "STES": 0.02, "SUCG": 0.001 },
    "V": { "SARP": 0, "SCAVA": 0, "SEMR": 0, "SEST": 0, "SGUS": 0, "SHD": 0, "SMST": 0, "SPES": 0, "SREC": 0, "SSHR": 0, "STES": 0, "SUCG": 0 },
    "Al": { "SARP": 0.005, "SCAVA": 0, "SEMR": 0.01, "SEST": 0.01, "SGUS": 0.00025, "SHD": 0.01, "SMST": 0, "SPES": 0.00333333333333333, "SREC": 0.0075, "SSHR": 0.01, "STES": 0.005, "SUCG": 0.001 },
    "Zn": { "SARP": 0.2, "SCAVA": 0, "SEMR": 1.1, "SEST": 0, "SGUS": 0.00025, "SHD": 0.2, "SMST": 0.6, "SPES": 0, "SREC": 0, "SSHR": 0.3, "STES": 0.3, "SUCG": 0.001 },
    "Pb": { "SARP": 0, "SCAVA": 0, "SEMR": 0, "SEST": 0, "SGUS": 0, "SHD": 0.01, "SMST": 0, "SPES": 0, "SREC": 0.0005, "SSHR": 0.01, "STES": 0, "SUCG": 0 },
    "Hg": { "SARP": 0, "SCAVA": 0, "SEMR": 0, "SEST": 0, "SGUS": 0, "SHD": 0, "SMST": 0, "SPES": 0, "SREC": 0, "SSHR": 0, "STES": 0, "SUCG": 0 },
    "N": { "SARP": 0, "SCAVA": 0.012, "SEMR": 0.01, "SEST": 0.01, "SGUS": 0.0085, "SHD": 0.012, "SMST": 0.012, "SPES": 0, "SREC": 0.011, "SSHR": 0.012, "STES": 0.012, "SUCG": 0.01 },
    "Fe": { "SARP": 55.766, "SCAVA": 88.208, "SEMR": 97.055, "SEST": 98.32, "SGUS": 93.60225, "SHD": 95.017, "SMST": 89.688, "SPES": 91.6333333333333, "SREC": 82.4805, "SSHR": 92.648, "STES": 86.2355, "SUCG": 91.145 },
    "FeO": { "SARP": 0, "SCAVA": 0, "SEMR": 0, "SEST": 0, "SGUS": 0, "SHD": 0, "SMST": 0, "SPES": 0, "SREC": 5.2725, "SSHR": 0, "STES": 0, "SUCG": 0 },
    "Rust": { "SARP": 4, "SCAVA": 2, "SEMR": 0.25, "SEST": 0, "SGUS": 0.425, "SHD": 0.7, "SMST": 2.5, "SPES": 1.43333333333333, "SREC": 3.25, "SSHR": 1, "STES": 2, "SUCG": 1.1 },
    "OilGreasesRubber": { "SARP": 35, "SCAVA": 5, "SEMR": 0.15, "SEST": 0.1, "SGUS": 0, "SHD": 0.5, "SMST": 1, "SPES": 0.866666666666667, "SREC": 0.1, "SSHR": 1, "STES": 1.001, "SUCG": 0 },
    "PaintingsCoatings": { "SARP": 0, "SCAVA": 0, "SEMR": 0, "SEST": 0, "SGUS": 0, "SHD": 0.5, "SMST": 0.5, "SPES": 0.833333333333333, "SREC": 0.05, "SSHR": 0.5, "STES": 0.6015, "SUCG": 0.25 },
    "NonMetalics": { "SARP": 4, "SCAVA": 2, "SEMR": 0.45, "SEST": 0.3, "SGUS": 0.42275, "SHD": 1.531, "SMST": 4, "SPES": 3.33333333333333, "SREC": 7.5, "SSHR": 2.5, "STES": 7.6, "SUCG": 2.3 },
    "H2O": { "SARP": 0.1, "SCAVA": 1, "SEMR": 0.1, "SEST": 0.2, "SGUS": 0.075, "SHD": 0, "SMST": 0, "SPES": 0.1, "SREC": 0.05, "SSHR": 0.5, "STES": 0.5, "SUCG": 0 }
}

function ScrapToElement(run_df) {
  let df_elements = [];

  for (const run of run_df) {
    let df_run_elements = {
      "BatchCode": run['BatchCode']
    };

    for (const [elemento, sucatas] of Object.entries(lib_quimico2sucata)) {
      let quantidade_total_carreg_1 = 0;
      let quantidade_total_carreg_2 = 0;

      for (const [sucata, porcentagem] of Object.entries(sucatas)) {
        quantidade_total_carreg_1 += run[sucata + "_Carreg_1"] * porcentagem / 100;
        quantidade_total_carreg_2 += run[sucata + "_Carreg_2"] * porcentagem / 100;
      }

      df_run_elements[elemento + "_Carreg_1"] = quantidade_total_carreg_1;
      df_run_elements[elemento + "_Carreg_2"] = quantidade_total_carreg_2;
    }

    df_elements.push(df_run_elements);
  }

  return df_elements;
}

module.exports = { lib_quimico2sucata, ScrapToElement };
